
function Apu(snes) {

  this.snes = snes;

  this.spc = new Spc(this);

  this.bootRom = new Uint8Array([
    0xcd, 0xef, 0xbd, 0xe8, 0x00, 0xc6, 0x1d, 0xd0, 0xfc, 0x8f, 0xaa, 0xf4, 0x8f, 0xbb, 0xf5, 0x78,
    0xcc, 0xf4, 0xd0, 0xfb, 0x2f, 0x19, 0xeb, 0xf4, 0xd0, 0xfc, 0x7e, 0xf4, 0xd0, 0x0b, 0xe4, 0xf5,
    0xcb, 0xf4, 0xd7, 0x00, 0xfc, 0xd0, 0xf3, 0xab, 0x01, 0x10, 0xef, 0x7e, 0xf4, 0x10, 0xeb, 0xba,
    0xf6, 0xda, 0x00, 0xba, 0xf4, 0xc4, 0xf4, 0xdd, 0x5d, 0xd0, 0xdb, 0x1f, 0x00, 0x00, 0xc0, 0xff
  ]);

  this.ram = new Uint8Array(0x10000);

  this.reset = function() {
    clearArray(this.ram);

    this.spc.reset();
  }
  this.reset();

  this.cycle = function() {
    this.spc.cycle();
  }

  this.read = function(adr) {
    adr &= 0xffff;

    if(adr >= 0xffc0) {
      return this.bootRom[adr & 0x3f];
    }

    return this.ram[adr];
  }

  this.write = function(adr, value) {
    adr &= 0xffff;

    //log("Written $" + getByteRep(value) + " to $" + getWordRep(adr));

    this.ram[adr] = value;
  }
}
